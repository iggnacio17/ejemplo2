<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestor de Videos</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #1e1e1e;
      color: #ffffff;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #ffffff;
      text-align: center;
    }
    .formulario, .galeria {
      max-width: 800px;
      margin: auto;
      padding: 10px;
      background: #2c2c2c;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    input, select, button {
      padding: 8px;
      margin: 5px;
      border-radius: 5px;
      border: none;
    }
    input, select {
      width: 200px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    .video-card {
      background: #3a3a3a;
      padding: 10px;
      border-radius: 10px;
      margin: 10px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .video-card img {
      width: 100%;
      max-width: 300px;
      border-radius: 10px;
      cursor: pointer;
    }
    .video-card p {
      margin: 5px 0;
    }
    .video-card .video-name {
      font-weight: bold;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>üé• Gestor de Videos</h1>

  <!-- Navegaci√≥n entre pesta√±as -->
  <div style="text-align:center; margin-bottom: 20px;">
    <button onclick="mostrarSeccion('galeria')">üéûÔ∏è Galer√≠a</button>
    <button onclick="mostrarSeccion('formulario')">‚ûï Nuevo Video</button>
  </div>

  <!-- Buscador -->
  <div id="buscadorContainer" style="text-align: center; margin-bottom: 20px; display: none;">
    <input type="text" id="buscador" placeholder="Buscar por nombre, categor√≠a o carpeta...">
    <button onclick="filtrarVideos()">Buscar</button>
  </div>

  <!-- Formulario -->
  <div class="formulario" id="formulario" style="display: none;">
    <input type="text" id="videoUrl" placeholder="Enlace del video">
    <input type="text" id="imageUrl" placeholder="Enlace de la imagen">
    <input type="text" id="videoNombre" placeholder="Nombre del video">
    <input type="text" id="nuevaActriz" placeholder="Agregar actriz">
    <select id="actrizSelect"></select>
    <input type="text" id="nuevaCategoria" placeholder="Agregar categor√≠a">
    <select id="categoriaSelect"></select>
    <select id="carpetaSelect"></select>
    <input type="text" id="nuevaCarpeta" placeholder="Nueva carpeta">
    <button onclick="guardarVideo()">Guardar Video</button>
  </div>

  <!-- Galer√≠a -->
  <div class="galeria" id="galeria" style="display: none;"></div>

  <script>
    const actoresKey = 'actrices';
    const categoriasKey = 'categorias';
    const carpetasKey = 'carpetas';
    const videosKey = 'videos';

    const actrizSelect = document.getElementById('actrizSelect');
    const categoriaSelect = document.getElementById('categoriaSelect');
    const carpetaSelect = document.getElementById('carpetaSelect');
    const buscador = document.getElementById('buscador');

    function getData(key) {
      return JSON.parse(localStorage.getItem(key)) || [];
    }

    function setData(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }

    function actualizarSelect(select, items) {
      select.innerHTML = '';
      items.forEach(item => {
        const option = document.createElement('option');
        option.value = item;
        option.textContent = item;
        select.appendChild(option);
      });
    }

    function cargarDatosIniciales() {
      actualizarSelect(actrizSelect, getData(actoresKey));
      actualizarSelect(categoriaSelect, getData(categoriasKey));
      actualizarSelect(carpetaSelect, getData(carpetasKey));
      cargarVideos();
    }

    function mostrarSeccion(seccion) {
      const galeria = document.getElementById('galeria');
      const formulario = document.getElementById('formulario');
      const buscadorContainer = document.getElementById('buscadorContainer');

      if (seccion === 'galeria') {
        galeria.style.display = 'block';
        formulario.style.display = 'none';
        buscadorContainer.style.display = 'block';
        cargarVideos();
      } else {
        galeria.style.display = 'none';
        formulario.style.display = 'block';
        buscadorContainer.style.display = 'none';
      }
    }

    function guardarVideo() {
      const videoUrl = document.getElementById('videoUrl').value;
      const imageUrl = document.getElementById('imageUrl').value;
      const videoNombre = document.getElementById('videoNombre').value;
      const nuevaActriz = document.getElementById('nuevaActriz').value;
      const nuevaCategoria = document.getElementById('nuevaCategoria').value;
      const nuevaCarpeta = document.getElementById('nuevaCarpeta').value;

      let actrices = getData(actoresKey);
      let categorias = getData(categoriasKey);
      let carpetas = getData(carpetasKey);

      if (nuevaActriz && !actrices.includes(nuevaActriz)) {
        actrices.push(nuevaActriz);
        setData(actoresKey, actrices);
      }
      if (nuevaCategoria && !categorias.includes(nuevaCategoria)) {
        categorias.push(nuevaCategoria);
        setData(categoriasKey, categorias);
      }
      if (nuevaCarpeta && !carpetas.includes(nuevaCarpeta)) {
        carpetas.push(nuevaCarpeta);
        setData(carpetasKey, carpetas);
      }

      const video = {
        videoUrl,
        imageUrl,
        videoNombre,
        actriz: nuevaActriz || actrizSelect.value,
        categoria: nuevaCategoria || categoriaSelect.value,
        carpeta: nuevaCarpeta || carpetaSelect.value
      };

      let lista = getData(videosKey);
      lista.push(video);
      setData(videosKey, lista);

      document.getElementById('videoUrl').value = '';
      document.getElementById('imageUrl').value = '';
      document.getElementById('videoNombre').value = '';
      document.getElementById('nuevaActriz').value = '';
      document.getElementById('nuevaCategoria').value = '';
      document.getElementById('nuevaCarpeta').value = '';

      cargarDatosIniciales();
    }

    function cargarVideos() {
      const galeria = document.getElementById('galeria');
      galeria.innerHTML = '';
      const videos = getData(videosKey);

      videos.forEach((video, index) => {
        const card = crearCard(video, index);
        galeria.appendChild(card);
      });
    }

    function crearCard(video, index) {
      const card = document.createElement('div');
      card.className = 'video-card';

      const img = document.createElement('img');
      img.src = video.imageUrl;
      img.onclick = () => window.open(video.videoUrl, '_blank');

      const desc = document.createElement('p');
      desc.textContent = `üé≠ ${video.actriz} | üóÇÔ∏è ${video.categoria} | üìÅ ${video.carpeta}`;

      const nombre = document.createElement('div');
      nombre.className = 'video-name';
      nombre.textContent = video.videoNombre;

      const editar = document.createElement('button');
      editar.textContent = 'Editar';
      editar.onclick = () => editarVideo(video, index);

      const del = document.createElement('button');
      del.textContent = 'Eliminar';
      del.onclick = () => {
        const videos = getData(videosKey);
        const nuevaLista = videos.filter((_, i) => i !== index);
        setData(videosKey, nuevaLista);
        cargarVideos();
      };

      const menuContextual = (e) => {
        e.preventDefault();
        const menu = document.createElement('div');
        menu.style.position = 'absolute';
        menu.style.top = `${e.clientY}px`;
        menu.style.left = `${e.clientX}px`;
        menu.style.backgroundColor = '#444';
        menu.style.padding = '10px';
        menu.style.borderRadius = '5px';
        menu.style.color = '#fff';
        menu.style.zIndex = '9999';

        const abrir = document.createElement('button');
        abrir.textContent = 'Abrir en nueva pesta√±a';
        abrir.onclick = () => window.open(video.videoUrl, '_blank');

        const copiar = document.createElement('button');
        copiar.textContent = 'Copiar enlace';
        copiar.onclick = () => {
          navigator.clipboard.writeText(video.videoUrl);
          alert('Enlace copiado');
        };

        const eliminar = document.createElement('button');
        eliminar.textContent = 'Eliminar';
        eliminar.onclick = () => {
          const videos = getData(videosKey);
          const nuevaLista = videos.filter((_, i) => i !== index);
          setData(videosKey, nuevaLista);
          cargarVideos();
          document.body.removeChild(menu);
        };

        menu.appendChild(abrir);
        menu.appendChild(copiar);
        menu.appendChild(eliminar);
        document.body.appendChild(menu);

        document.addEventListener('click', () => {
          if (document.body.contains(menu)) {
            document.body.removeChild(menu);
          }
        });
      };

      img.addEventListener('contextmenu', menuContextual);

      card.appendChild(img);
      card.appendChild(desc);
      card.appendChild(nombre);
      card.appendChild(editar);
      card.appendChild(del);

      return card;
    }

    function editarVideo(video, index) {
      document.getElementById('videoUrl').value = video.videoUrl;
      document.getElementById('imageUrl').value = video.imageUrl;
      document.getElementById('videoNombre').value = video.videoNombre;
      document.getElementById('nuevaActriz').value = video.actriz;
      document.getElementById('nuevaCategoria').value = video.categoria;
      document.getElementById('nuevaCarpeta').value = video.carpeta;

      const videos = getData(videosKey);
      videos.splice(index, 1);
      setData(videosKey, videos);

      mostrarSeccion('formulario');
    }

    function filtrarVideos() {
      const query = buscador.value.toLowerCase();
      const videos = getData(videosKey);
      const filtrados = videos.filter(video =>
        video.videoNombre.toLowerCase().includes(query) ||
        video.categoria.toLowerCase().includes(query) ||
        video.carpeta.toLowerCase().includes(query)
      );

      const galeria = document.getElementById('galeria');
      galeria.innerHTML = '';
      filtrados.forEach((video, index) => {
        const card = crearCard(video, index);
        galeria.appendChild(card);
      });
    }

    // Inicializaci√≥n
    cargarDatosIniciales();
    mostrarSeccion('galeria');
  </script>
</body>
</html>
